# HTTP Server

## Important files and folders
* **[mix.exs](./mix.exs)**: Application level settings. Noteworthy is the dependency *opentelemetry_ecto*, together with `OpentelemetryEcto.setup([:simple_telemetry, :repo])` in [application.ex](./lib/simple_telemetry/application.ex), which automatically exports traces for all database queries.
* **[lib/simple_telemetry_web/router.ex](./lib/simple_telemetry_web/router.ex)**: Contains the mapping between exposed endpoints and endpoint implementation.
* **[lib/simple_telemetry_web/controllers/dog_controller.ex](./lib/simple_telemetry_web/controllers/dog_controller.ex)**: Endpoint implementations. Uses the next file to communicate with the database. Generates custom traces.
* **[lib/simple_telemetry/farm.ex](./lib/simple_telemetry/farm.ex)**: Implements communication with the database. The file is generated by the Phoenix library using generator commands: [Phoenix generator commands](https://hexdocs.pm/phoenix/Mix.Tasks.Phx.Gen.html)


## Deployment
### Local
Requires a database connection referenced in [config/dev.exs](./config/dev.exs)
To start Phoenix server:

* Run `mix setup` to install and setup dependencies
* Start Phoenix endpoint with `mix phx.server` or inside IEx with `iex -S mix phx.server`


### Docker
Requires a database connection referenced in [config/release.exs](./config/runtime.exs)
```bash
docker build -t http-server .
docker run -it --rm -p 4000:4000 -e ecto://USER:PASS@HOST/DATABASE http-server
```

### Deploy trace collector
```bash
docker compose up
```

Now you can visit [`localhost:4000/api/hello/world`](http://localhost:4000) from your browser.





## Learn more
* Official website: https://www.phoenixframework.org/
* Guides: https://hexdocs.pm/phoenix/overview.html
* Docs: https://hexdocs.pm/phoenix
* Forum: https://elixirforum.com/c/phoenix-forum
* Source: https://github.com/phoenixframework/phoenix
