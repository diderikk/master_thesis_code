mode: daemonset

presets:
  # enables the k8sattributesprocessor and adds it to the traces, metrics, and logs pipelines
  kubernetesAttributes:
    enabled: true
    extractAllPodLabels: true
    extractAllPodAnnotations: true
  # enables the kubeletstatsreceiver and adds it to the metrics pipelines
  kubeletMetrics:
    enabled: true
  hostMetrics:
    enabled: true
  # Enables the filelogreceiver and adds it to the logs pipelines
  # logsCollection:
  #   enabled: true

config:
  extensions:
    zpages: {}
    basicauth/traces:
      client_auth:
        username: "799271"
        password: "glc_eyJvIjoiMTA0NDQ1MCIsIm4iOiJvcGVuLXRlbGVtZXRyeS10b2tlbi1rdWJlcm5ldGVzIiwiayI6ImxTUTAzenNXTDZhUjNXODBnTDMyN0NJMCIsIm0iOnsiciI6InVzIn19"
    basicauth/metrics:
      client_auth:
        username: "1405159"
        password: "glc_eyJvIjoiMTA0NDQ1MCIsIm4iOiJvcGVuLXRlbGVtZXRyeS10b2tlbi1rdWJlcm5ldGVzIiwiayI6ImxTUTAzenNXTDZhUjNXODBnTDMyN0NJMCIsIm0iOnsiciI6InVzIn19"
    basicauth/logs:
      client_auth:
        username: "801571"
        password: "glc_eyJvIjoiMTA0NDQ1MCIsIm4iOiJvcGVuLXRlbGVtZXRyeS10b2tlbi1rdWJlcm5ldGVzIiwiayI6ImxTUTAzenNXTDZhUjNXODBnTDMyN0NJMCIsIm0iOnsiciI6InVzIn19" 
    basicauth/otlp:
      client_auth:
        username: "847172"
        password: "glc_eyJvIjoiMTA0NDQ1MCIsIm4iOiJzdGFjay04NDcxNzItb3RscC13cml0ZS1vdGxwLXRva2VuIiwiayI6Inl0WThEV3JoOTA3WEE3NXR4TXgwNjk0UyIsIm0iOnsiciI6InByb2QtZXUtbm9ydGgtMCJ9fQ=="
  # OpenTelemetry Collector config that receives OTLP and exports to Zipkin
  receivers:
    kubeletstats:
      collection_interval: 10s
      auth_type: "serviceAccount"
      endpoint: "ec2-16-171-192-210.eu-north-1.compute.amazonaws.com:10250"
      insecure_skip_verify: true
      extra_metadata_labels:
        - container.id
    otlp:
      protocols:
        grpc:
          endpoint: "0.0.0.0:4317"
        http:
          endpoint: "0.0.0.0:4318"
    jaeger: null
    zipkin: null
    prometheus: null
  processors:
    batch:
      send_batch_size: 1024
      timeout: 5s
    k8sattributes:
      auth_type: "serviceAccount"
      passthrough: false
      filter:
        node_from_env_var: worker1
      extract:
        metadata:
        - k8s.pod.name
        - k8s.pod.uid
        - k8s.deployment.name
        - k8s.namespace.name
        - k8s.node.name
        - k8s.pod.start_time
  exporters:
    otlp:
      endpoint: tempo-prod-18-prod-eu-north-0.grafana.net:443
      tls:
        insecure: false
      auth:
        authenticator: basicauth/traces
    otlphttp:
      endpoint: http://simplest-collector.default.svc.cluster.local:4318
      tls:
        insecure: true
    # otlphttp:
    #   endpoint: https://otlp-gateway-prod-eu-north-0.grafana.net/otlp
    #   tls:
    #     insecure: false
    #   auth:
    #     authenticator: basicauth/otlp
    prometheusremotewrite:
      endpoint: https://prometheus-prod-39-prod-eu-north-0.grafana.net/api/prom/push
      auth: 
        authenticator: basicauth/metrics
    debug: 
      verbosity: detailed

  service:
    telemetry:
      logs:
        level: "debug"
    extensions: [health_check, zpages, basicauth/otlp, basicauth/traces, basicauth/metrics, basicauth/logs]
    pipelines:
      traces:
        receivers: [otlp]
        exporters: [debug, otlp, otlphttp]
      metrics:
        receivers: [otlp, kubeletstats]
        processors: [batch, k8sattributes]
        exporters: [debug, prometheusremotewrite]
      logs: 
        receivers: [otlp]
        exporters: [debug]
